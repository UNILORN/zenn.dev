---
title: "PHP Staticãƒ¡ã‚½ãƒƒãƒ‰ã§ClassInstanceã‚’è¿”å´ã—ã¤ã¤ã€ãƒ‘ã‚¤ãƒ—ã®ã‚ˆã†ã«å®Ÿè¡Œã—ã¦ã„ãæ–¹æ³•(new static)"
emoji: "ðŸ¦”"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["php"]
published: true
---

## æ¦‚è¦

PHPã®ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆæ™‚ã€`new ClassName()` ã‚’ã—ãŸã‚Šã€ `new ClassName('å¼•æ•°1')` ã§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œã£ã¦ã‹ã‚‰å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã®ãŒä¸€èˆ¬çš„ã‹ã¨æ€ã‚ã‚Œã¾ã™ã€‚
ãŸã ã€Laravel Eloquent Modelã§ã™ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªæ›¸ãæ–¹ãŒå‡ºæ¥ã¾ã™ã€‚

```php
EloquentModel::query()->get();
EloquentModel::where('column', 'sample')->get();
```

é€šå¸¸ã®Classã®ä½œã‚Šæ–¹ã§ã‚‚å®Ÿè¡ŒãŒå¯èƒ½ã§ã™ã€‚

```php
$model new EloquentModel();
$model->get();

$model new EloquentModel();
$model->where('column', 'sample')->get();
```

`static` ãªãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€ã“ã®ã‚ˆã†ãªæ–¹æ³•ãŒæŽ¡ã‚Œã‚‹ã®ã¯staticãƒ¡ã‚½ãƒƒãƒ‰ã§è‡ªèº«ã®ã‚¯ãƒ©ã‚¹ã‚’ã—ã¦ã„ã‚‹äº‹ã«ãªã‚Šã¾ã™ã€‚

ä»Šå›žã¯ãã®ã‚ˆã†ãªã‚¯ãƒ©ã‚¹ã®å®Ÿè£…ã‚’ã—ã¦ã¿ã‚ˆã†ã‹ã¨æ€ã„ã¾ã™ã€‚

## ã‚¯ãƒ©ã‚¹ã‚’å®Ÿè£…ã—ã¦ã¿ã‚‹

```php

interface SampleClassInterface
{
    public function __construct();
}

class SampleClass implements SampleClassInterface
{
    private string $desert = "";

    public function __construct()
    {
    }

    // ã‚±ãƒ¼ã‚­ã‚’ä½œã‚‹
    public static function makeCake(string $name): self
    {
        return (new static)->newDesert($name . 'Cake');
    }

    // ãƒžãƒ•ã‚£ãƒ³ã‚’ä½œã‚‹
    public static function makeMuffin(string $name): self
    {
        return (new static)->newDesert($name . 'Muffin');
    }

    // ãƒ‡ã‚¶ãƒ¼ãƒˆã«ã™ã‚‹
    private function newDesert(string $name): self
    {
        $this->desert = $name;
        return $this;
    }

    // ãƒˆãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹
    public function topping(string $name): self
    {
        $this->desert .= ' and ' .$name;
        return $this;
    }

    // ä½œã£ãŸãƒ‡ã‚¶ãƒ¼ãƒˆã‚’å–å¾—ã™ã‚‹
    public function get(): string
    {
        return $this->desert;
    }
}
```

ä¸Šè¨˜ã®ã‚ˆã†ãªå®Ÿè£…ã‚’ã™ã‚‹ã“ã¨ã§ã€Staticãªãƒ¡ã‚½ãƒƒãƒ‰ã‹ã‚‰ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã—ãŸå¾Œãƒ‘ã‚¤ãƒ—ã§å‡¦ç†ã‚’è¿½åŠ ã—ã¦ã„ã‘ã¾ã™ã€‚

### è»½ãè§£èª¬

```php
interface SampleClassInterface
{
    public function __construct();
}

class SampleClass implements SampleClassInterface
{
    public function __construct()
    {
    }
}
```

ã“ã“ã¯ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’å®šç¾©ã—ã¦ã„ã¾ã™ãŒã€ `(new static)` ã‚’ã—ãŸã¨ãã«ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®å¼•æ•°ãŒãªã„äº‹ã‚’ Interface ã§ç¸›ã£ã¦ã„ã¾ã™ã€‚
è¨˜è¿°ãŒãªã„å ´åˆã¯PHP Stanãªã©ã§é™çš„è§£æžã‚’ä½¿ã£ã¦ã„ã‚‹ã¨ã“ã®ã‚ãŸã‚Šã§ã‚³ã‚±ã‚‹ã¯ãšãªã®ã§ã€è¨˜è¿°ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

```php
// ã‚±ãƒ¼ã‚­ã‚’ä½œã‚‹
public static function makeCake(string $name): self
{
    return (new static)->newDesert($name . 'Cake');
}

// ãƒžãƒ•ã‚£ãƒ³ã‚’ä½œã‚‹
public static function makeMuffin(string $name): self
{
    return (new static)->newDesert($name . 'Muffin');
}
```

Staticã§å‘¼ã°ã‚Œã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ç¾¤ã§ã™ã€‚
ã“ã“ã§ã¯ã‚±ãƒ¼ã‚­ã¨ãƒžãƒ•ã‚£ãƒ³ã®ã©ã¡ã‚‰ã‚‚ä½œã‚Œã‚‹ã‚ˆã†ã«ã—ã¦ãŠãã¾ã—ãŸã€‚
ã‚±ãƒ¼ã‚­ã‚‚ãƒžãƒ•ã‚£ãƒ³ã‚‚åŒã˜ãƒ‡ã‚¶ãƒ¼ãƒˆãªã®ã§ `newDesert` ã§ãƒ‡ã‚¶ãƒ¼ãƒˆã‚’ä½œã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å©ã„ã¦ã„ã¾ã™ã€‚


```php
// ãƒ‡ã‚¶ãƒ¼ãƒˆã«ã™ã‚‹
private function newDesert(string $name): self
{
    $this->desert = $name;
    return $this;
}
```

Privateãªãƒ¡ã‚½ãƒƒãƒ‰ã§Staticãƒ¡ã‚½ãƒƒãƒ‰ã® `new static` å¾Œã«å‘¼ã°ã‚Œã‚‹ã“ã¨ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã€‚
ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¨ã»ã¼åŒã˜æ‰±ã„ã«ãªã‚‹ã‹ã¨æ€ã„ã¾ã™ãŒã€å¥½ããªStaticãƒ¡ã‚½ãƒƒãƒ‰ã‹ã‚‰å¥½ããªã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’å‘¼ã¹ã‚‹ç‚¹ãŒæ™®é€šã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¨ã¯é•ã†ç‚¹ã¨ãªã‚Šã¾ã™ã€‚

```php
// ãƒˆãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹
public function topping(string $name): self
{
    $this->desert .= ' and ' .$name;
    return $this;
}
```

é–¢æ•°ã‚’ãƒ‘ã‚¤ãƒ—ã®ã‚ˆã†ã«å®Ÿè¡Œã™ã‚‹ç‚ºã®ç‰©ã§ã™ã€‚

`SampleClass::makeCake('cake')->topping('chocolate')->get();` ã®ã‚ˆã†ã«é–“ã«æŒŸã‚€ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚

```php
// ä½œã£ãŸãƒ‡ã‚¶ãƒ¼ãƒˆã‚’å–å¾—ã™ã‚‹
public function get(): string
{
    return $this->desert;
}
```

ã‚²ãƒƒã‚¿ãƒ¼ã§ã™ã€‚ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å¤‰æ•°ã‚’ `public` ã«ã—ã¦ã‚‚ã„ã„ã§ã™ãŒã€ `private` ã¨ã—ãŸå ´åˆã¯ã“ã®ã‚ˆã†ã«ã‚²ãƒƒã‚¿ãƒ¼ã‚’ä½œæˆã—ã¾ã™ã€‚

## ã¤ã‹ã†ã¨ã©ã†ãªã‚‹

```php
$chocolateCake = SampleClass::makeCake('cake')
    ->topping('chocolate')
    ->get();

$englishMuffin = SampleClass::makeMuffin('muffin')
    ->topping('cornmeal')
    ->get();
```

ä»¥ä¸Šã€‚