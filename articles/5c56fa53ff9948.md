---
title: "Laravel Octane, OpenSwoole„Çµ„Éº„ÉêËµ∑ÂãïÊôÇ„Å´‰∏çÊòé„Å™„Ç®„É©„Éº„ÅåÂá∫„Åü‰ª∂"
emoji: "üéâ"
type: "tech" # tech: ÊäÄË°ìË®ò‰∫ã / idea: „Ç¢„Ç§„Éá„Ç¢
topics: ["Laravel", "PHP", "Octane"]
published: true
---

## ÂéüÂõ†„Å®Ëß£Ê±∫ÊñπÊ≥ï

ÂéüÂõ†: Èùûroot„É¶„Éº„Ç∂„Éº„ÅßÂÆüË°å„Åô„Çã Alpine „Éô„Éº„Çπ„ÅÆ„Ç≥„É≥„ÉÜ„Éä„Åß80Áï™„Éù„Éº„Éà„ÅßÁ´ã„Å°‰∏ä„Åí„Çà„ÅÜ„Å®„Åô„Çã„Å®Ê®©Èôê„Ç®„É©„Éº„Å®„Å™„Çã
ÂØæÁ≠ñÊ≥ï: 80Áï™„Éù„Éº„Éà‰ª•Â§ñ„ÅÆ„Éù„Éº„Éà„ÇíÂà©Áî®„Åô„Çã

Âà©Áî®„Åó„Å¶„ÅÑ„ÇãOSS„ÅÆIssue„Å∏Ë≥™Âïè„Åó„ÄÅËß£Ê±∫„ÅÑ„Åü„Åó„Åæ„Åó„Åü„ÄÇ

https://github.com/exaco/laravel-octane-dockerfile/issues/71

## „Å©„ÅÜ„ÇÑ„Å£„Å¶Áô∫Ë¶ã„Åó„Åü„Åã

ÊúÄÂàù„ÅØ„Çà„ÅèÂàÜ„Åã„Çâ„Å™„ÅÑ„Ç®„É©„Éº„Åß„Åó„Åü„ÄÇ

```
PHP Fatal error:  Uncaught Error: Class "Laravel\Octane\Octane" not found in /var/www/html/vendor/laravel/octane/src/Stream.php:56

Stack trace:
#0 /var/www/html/vendor/laravel/octane/bin/createSwooleServer.php(19): Laravel\Octane\Stream::shutdown()
#1 /var/www/html/vendor/laravel/octane/bin/swoole-server(35): require('...')
#2 {main}
  thrown in /var/www/html/vendor/laravel/octane/src/Stream.php on line 56
Fatal error: Uncaught Error: Class "Laravel\Octane\Octane" not found in /var/www/html/vendor/laravel/octane/src/Stream.php:56
2024-04-25 16:50:52,441 INFO exited: octane_00 (exit status 255; not expected)
```


`Class "Laravel\Octane\Octane" not found in /var/www/html/vendor/laravel/octane/src/Stream.php:56`

![](https://storage.googleapis.com/zenn-user-upload/b03036b776f9-20240515.png)

„Å©„ÅÜ„ÇÑ„Çâ„ÄÅLaravel Octane„ÅÆ OpenSwoole„Çµ„Éº„ÉêËµ∑ÂãïÊôÇ„ÅÆ„Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞„ÅåÂÑ™„Åó„Åè„Å™„ÅÑÁä∂ÊÖã„Å®„ÅÑ„ÅÜ‰∫ã„Çâ„Åó„ÅÑ„Åß„Åô„ÄÇ

### Laravel Octane„ÅÆË©≤ÂΩìÂ†¥ÊâÄ„ÇíË¶ã„Å§„Åë„Çã

https://github.com/laravel/octane/blob/2.x/bin/createSwooleServer.php#L19

```php
try {
    $host = $serverState['host'] ?? '127.0.0.1';

    $sock = filter_var($host, FILTER_VALIDATE_IP, FILTER_FLAG_IPV4) ? SWOOLE_SOCK_TCP : SWOOLE_SOCK_TCP6;

    $server = new Swoole\Http\Server(
        $host,
        $serverState['port'] ?? 8000,
        $config['swoole']['mode'] ?? SWOOLE_PROCESS,
        ($config['swoole']['ssl'] ?? false)
            ? $sock | SWOOLE_SSL
            : $sock,
    );
} catch (Throwable $e) {
    Laravel\Octane\Stream::shutdown($e);

    exit(1);
```

Ë©≤ÂΩìÂ†¥ÊâÄ„ÇíË¶ã„Å§„Åë„Åæ„Åó„Åü„ÄÇ
Octane„Çí„É≠„Éº„Ç´„É´„Å´ÊåÅ„Å£„Å¶„Åç„Å¶„ÄÅË©≤ÂΩìÂ†¥ÊâÄ„ÇíÊ∂à„Åó„Å¶„Åø„ÅüÁâ©„Çí composer.json„Åß„É≠„Éº„Ç´„É´Ë™≠Ëæº„Çí„Åó„Å¶„Åø„Åæ„Åô„ÄÇ

### „Ç®„É©„Éº„É≠„Ç∞„ÅåÂá∫„ÇãÁä∂ÊÖã„ÅßËµ∑Âãï„Åô„Çã

```
PHP Fatal error:  Uncaught Swoole\Exception: failed to listen server port[0.0.0.0:80], Error: Permission denied[13] in /var/www/html/vendor/laravel/octane/bin/createSwooleServer.php:10                                                                                             
Stack trace:                                                                                                                                                                                                                                                                         
#0 /var/www/html/vendor/laravel/octane/bin/createSwooleServer.php(10): Swoole\Server->__construct()                                                                                                                                                                                  
#1 /var/www/html/vendor/laravel/octane/bin/swoole-server(35): require('...')                                                                                                                                                                                                         
#2 {main}                                                                                                                                                                                                                                                                            
  thrown in /var/www/html/vendor/laravel/octane/bin/createSwooleServer.php on line 10                                                                                                                                                                                                
Fatal error: Uncaught Swoole\Exception: failed to listen server port[0.0.0.0:80], Error: Permission denied[13] in /var/www/html/vendor/laravel/octane/bin/createSwooleServer.php:10
```

`Error: Permission denied[13]`

‰ªäÂõû„ÅØ„Åó„Å£„Åã„ÇäÂá∫„Å¶„Åè„Çå„Åæ„Åó„Åü„ÄÇ

### 80Áï™„Éù„Éº„Éà„ÅØ„ÉÄ„É°

https://blog.kasei-san.com/entry/2020/11/19/181224

> 0„Äú1023 „Åæ„Åß„ÅÆ„Éù„Éº„Éà„ÅØ well known port „Å®Âëº„Å∞„Çå„ÄÅÈñãÊîæ„Å´rootÊ®©Èôê„ÅåÂøÖË¶Å„Å™„Åü„ÇÅ

„Å®„ÅÑ„ÅÜ„Åì„Å®„Åß„Åó„Åü„ÅÆ„Åß„ÄÅ `8000` Áï™„Éù„Éº„Éà„ÅßË©¶„Åó„Å¶Ë¶ã„Åæ„Åô„ÄÇ

### 8000Áï™„ÅßË©¶„Åô

```
2024-04-30 01:43:42,241 INFO success: octane_00 entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)                                                                                                                                                        
                                                                                                                                                                                                                                                                                     
   INFO  Server running‚Ä¶                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                     
  Local: http://0.0.0.0:8000                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                     
  Press Ctrl+C to stop the server                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                     
  200    GET /health ........................................ 17.22 mb 62.77 ms                                                                                                                                                                                                      
  200    GET /health ......................................... 17.35 mb 3.90 ms
```

üéâ ÁÑ°‰∫ã„Å´Ëµ∑Âãï„Åó„Åæ„Åó„Åü

### ‰øÆÊ≠£ÂØæÂøú

https://github.com/exaco/laravel-octane-dockerfile/pull/73

‰øÆÊ≠£ÂØæÂøú„Åó„Åæ„Åó„Åü„ÅÆ„Åß„ÄÅLaravel Octane„ÅÆDockerfile„ÇíÂà©Áî®„Åô„ÇãÂ†¥Âêà„ÅØÊúÄÊñ∞Áâà„Çí„ÅîÂà©Áî®„Åè„Å†„Åï„ÅÑ„ÄÇ

## Ë¨ùËæû

https://github.com/exaco/laravel-octane-dockerfile

`smortexa` Êßò„ÅÇ„Çä„Åå„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åó„Åü„ÄÇ

